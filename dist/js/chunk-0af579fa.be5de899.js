(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0af579fa"],{"209b":function(e,t,r){},dd7b:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login"},[e._m(0),r("el-card",{staticClass:"loginForm",attrs:{shadow:"hover"}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"0"}},[r("el-form-item",{attrs:{prop:"account"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-message",autofocus:"true",placeholder:"请输入邮箱",maxLength:"50"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.pas.focus()}},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{ref:"pas",attrs:{placeholder:"请输入密码","show-password":"",maxLength:"20","prefix-icon":"el-icon-edit"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit("form")}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("el-form-item",{staticStyle:{"margin-bottom":"0"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("form")}}},[e._v("登录")]),r("el-button",{attrs:{plain:""},on:{click:e.resetForm}},[e._v("重置")]),r("br"),r("el-link",{staticClass:"to_register",on:{click:e.to_register}},[e._v("没有账号？立即注册")])],1)],1)],1)],1)},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",[r("figure")])}],a={name:"login",data:function(){return{form:{account:"",password:""},rules:{account:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入形如xx@xx.xx格式的邮箱",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{submit:function(e){var t=this;this.$route.params.to?this.$router.push(this.$route.params.to):this.$router.push({name:"index"}),this.$refs[e].validate((function(e){e?(t.$message({message:"验证成功，正在登录",type:"success"}),t.$axios.post("/user/login",{email:t.form.account,password:t.form.password}).then((function(e){0===e.status?(t.$message({message:"登录成功",type:"success"}),t.getUserInfo(),t.$route.params.to?t.$router.push(t.$route.params.to):t.$router.push({name:"index"})):(t.$message({message:"邮箱或密码错误",type:"error"}),t.resetForm())}))):t.$message({message:"验证失败，请重新填写",type:"error"})}))},to_register:function(){this.$route.params.to?this.$router.push({name:"register",params:{to:this.$route.params.to}}):this.$router.push({name:"register"})},resetForm:function(){this.$refs.form.resetFields()},getUserInfo:function(){var e=this;this.$axios.get("/user/user_info",{params:{id:0}}).then((function(t){200===t.status?(e.user_img=t.data.img,e.isLog=!0,localStorage.setItem("userId",t.data.id)):e.$message({message:"获取个人头像失败",type:"error"})})).catch((function(t){e.$message({message:t,type:"error"})}))}}},n=a,i=(r("fab2"),r("2877")),u=Object(i["a"])(n,s,o,!1,null,"0043a6f7",null);t["default"]=u.exports},fab2:function(e,t,r){"use strict";var s=r("209b"),o=r.n(s);o.a}}]);
//# sourceMappingURL=chunk-0af579fa.be5de899.js.map